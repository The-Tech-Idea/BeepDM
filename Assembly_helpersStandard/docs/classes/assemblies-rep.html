<!--
    assemblies_rep Class Documentation
    Professional-grade documentation for the assemblies_rep class.
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>assemblies_rep - Assembly Helpers Documentation</title>
    <link rel="stylesheet" href="../sphinx-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
</head>
<body>
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" onclick="toggleSidebar()">
        <i class="bi bi-list"></i>
    </button>

    <!-- Theme Toggle -->
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
        <i class="bi bi-sun-fill" id="theme-icon"></i>
    </button>

    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="logo">
                <img src="../assets/beep-logo.svg" alt="Beep Assembly Helpers Logo">
                <div class="logo-text">
                    <h2>Assembly Helpers</h2>
                    <span class="version">v1.0.0</span>
                </div>
            </div>
            
            <!-- Search -->
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Search documentation..." onkeyup="searchDocs(this.value)">
            </div>
            
            <nav>
                <ul class="nav-menu">
                    <li><a href="../index.html"><i class="bi bi-house"></i> Home</a></li>
                    <li class="has-submenu open">
                        <a href="#"><i class="bi bi-gear"></i> Core Classes</a>
                        <ul class="submenu">
                            <li><a href="assembly-handler.html">AssemblyHandler</a></li>
                            <li><a href="assembly-class-definition.html">AssemblyClassDefinition</a></li>
                            <li><a href="assemblies-rep.html" class="active">assemblies_rep</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a href="#"><i class="bi bi-plug"></i> Extensions</a>
                        <ul class="submenu">
                            <li><a href="../extensions/loader-extensions.html">Loader Extensions</a></li>
                            <li><a href="../extensions/scanning-extensions.html">Scanning Extensions</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a href="#"><i class="bi bi-database"></i> Drivers</a>
                        <ul class="submenu">
                            <li><a href="../drivers/connection-drivers.html">Connection Drivers</a></li>
                            <li><a href="../drivers/data-sources.html">Data Sources</a></li>
                            <li><a href="../drivers/ado-drivers.html">ADO.NET Drivers</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a href="#"><i class="bi bi-book"></i> Guides</a>
                        <ul class="submenu">
                            <li><a href="../guides/getting-started.html">Getting Started</a></li>
                            <li><a href="../guides/assembly-loading.html">Assembly Loading</a></li>
                            <li><a href="../guides/extension-scanning.html">Extension Scanning</a></li>
                            <li><a href="../guides/driver-management.html">Driver Management</a></li>
                        </ul>
                    </li>
                    <li><a href="../api/reference.html"><i class="bi bi-code-square"></i> API Reference</a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Page Header -->
                <div class="page-header">
                    <h1>assemblies_rep</h1>
                    <p class="page-subtitle">Representation class for loaded assembly metadata and tracking</p>
                    
                    <!-- Class Info -->
                    <div class="class-info">
                        <div class="info-item">
                            <span class="label">Namespace:</span>
                            <span class="value">TheTechIdea.Beep.Tools</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Assembly:</span>
                            <span class="value">DataManagementModels.dll</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Inherits:</span>
                            <span class="value">Entity</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Target Framework:</span>
                            <span class="value">.NET 8, .NET 9</span>
                        </div>
                    </div>
                </div>

                <!-- Overview -->
                <section class="section">
                    <h2>Overview</h2>
                    <p>
                        The <code>assemblies_rep</code> class serves as a representation and tracking mechanism 
                        for loaded assemblies within the Beep framework. It encapsulates an assembly along with 
                        metadata about its source location, classification, and loading context.
                    </p>
                    <p>
                        This class is essential for managing the lifecycle of loaded assemblies, providing 
                        categorization through FolderFileTypes, and maintaining references to both the 
                        assembly object and its file system location.
                    </p>
                </section>

                <!-- Class Declaration -->
                <section class="section">
                    <h2>Class Declaration</h2>
                    <div class="code-example">
                        <div class="code-header">
                            <span class="language">C#</span>
                            <button class="copy-btn" onclick="copyCode(this)">
                                <i class="bi bi-clipboard"></i>
                            </button>
                        </div>
                        <pre><code class="language-csharp">public class assemblies_rep : Entity
{
    // Constructor for creating assembly representations
    public assemblies_rep(Assembly pDllLib, string pDllLibPath, 
                         string pDllName, FolderFileTypes fileTypes)
}</code></pre>
                    </div>
                </section>

                <!-- Constructor -->
                <section class="section">
                    <h2>Constructor</h2>
                    <div class="method-signature">
                        <h3>assemblies_rep(Assembly, string, string, FolderFileTypes)</h3>
                        <p>Initializes a new instance of assemblies_rep with the specified assembly and metadata.</p>
                    </div>
                    
                    <div class="code-example">
                        <div class="code-header">
                            <span class="language">C#</span>
                            <button class="copy-btn" onclick="copyCode(this)">
                                <i class="bi bi-clipboard"></i>
                            </button>
                        </div>
                        <pre><code class="language-csharp">public assemblies_rep(
    Assembly pDllLib, 
    string pDllLibPath, 
    string pDllName, 
    FolderFileTypes fileTypes
)</code></pre>
                    </div>

                    <div class="parameters">
                        <h4>Parameters</h4>
                        <table class="params-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>pDllLib</code></td>
                                    <td><code>Assembly</code></td>
                                    <td>The loaded .NET Assembly object</td>
                                </tr>
                                <tr>
                                    <td><code>pDllLibPath</code></td>
                                    <td><code>string</code></td>
                                    <td>The file system path where the assembly was loaded from</td>
                                </tr>
                                <tr>
                                    <td><code>pDllName</code></td>
                                    <td><code>string</code></td>
                                    <td>The file name of the assembly DLL</td>
                                </tr>
                                <tr>
                                    <td><code>fileTypes</code></td>
                                    <td><code>FolderFileTypes</code></td>
                                    <td>Classification of the assembly type (Addin, DataSources, etc.)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="example">
                        <h4>Example</h4>
                        <div class="code-example">
                            <pre><code class="language-csharp">// Load an assembly and create representation
var assembly = Assembly.LoadFrom(@"C:\Plugins\MyPlugin.dll");

var assemblyRep = new assemblies_rep(
    assembly,
    @"C:\Plugins",
    "MyPlugin.dll",
    FolderFileTypes.Addin
);

Console.WriteLine($"Loaded: {assemblyRep.DllName}");</code></pre>
                        </div>
                    </div>
                </section>

                <!-- Properties -->
                <section class="section">
                    <h2>Properties</h2>
                    
                    <div class="property-list">
                        <div class="property-item">
                            <h3>ID</h3>
                            <div class="property-info">
                                <span class="type">int</span>
                                <span class="access">Public</span>
                            </div>
                            <p>Gets or sets the unique numeric identifier for the assembly representation.</p>
                        </div>

                        <div class="property-item">
                            <h3>GuidID</h3>
                            <div class="property-info">
                                <span class="type">string</span>
                                <span class="access">Public</span>
                            </div>
                            <p>Gets or sets the globally unique identifier, automatically generated on creation.</p>
                        </div>

                        <div class="property-item">
                            <h3>DllLib</h3>
                            <div class="property-info">
                                <span class="type">Assembly</span>
                                <span class="access">Public</span>
                            </div>
                            <p>Gets or sets the loaded .NET Assembly object.</p>
                            <div class="code-example">
                                <pre><code class="language-csharp">// Access the assembly for reflection operations
var types = assemblyRep.DllLib.GetTypes();
foreach (var type in types)
{
    Console.WriteLine($"Type: {type.FullName}");
}</code></pre>
                            </div>
                        </div>

                        <div class="property-item">
                            <h3>DllLibPath</h3>
                            <div class="property-info">
                                <span class="type">string</span>
                                <span class="access">Public</span>
                            </div>
                            <p>Gets or sets the directory path where the assembly was loaded from.</p>
                            <div class="code-example">
                                <pre><code class="language-csharp">// Check if assembly source directory exists
if (Directory.Exists(assemblyRep.DllLibPath))
{
    Console.WriteLine($"Assembly source: {assemblyRep.DllLibPath}");
}</code></pre>
                            </div>
                        </div>

                        <div class="property-item">
                            <h3>DllName</h3>
                            <div class="property-info">
                                <span class="type">string</span>
                                <span class="access">Public</span>
                            </div>
                            <p>Gets or sets the file name of the assembly DLL.</p>
                        </div>

                        <div class="property-item">
                            <h3>FileTypes</h3>
                            <div class="property-info">
                                <span class="type">FolderFileTypes</span>
                                <span class="access">Public</span>
                            </div>
                            <p>Gets or sets the classification of the assembly type.</p>
                            <div class="code-example">
                                <pre><code class="language-csharp">// Filter assemblies by type
var dataSourceAssemblies = assemblies
    .Where(rep => rep.FileTypes == FolderFileTypes.DataSources)
    .ToList();

var addinAssemblies = assemblies
    .Where(rep => rep.FileTypes == FolderFileTypes.Addin)
    .ToList();</code></pre>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- FolderFileTypes Enumeration -->
                <section class="section">
                    <h2>FolderFileTypes Classification</h2>
                    
                    <p>The FileTypes property uses the FolderFileTypes enumeration to classify assemblies:</p>
                    
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h3>Builtin</h3>
                            <p>Core system assemblies that are part of the main application</p>
                        </div>
                        <div class="feature-card">
                            <h3>DataSources</h3>
                            <p>Assemblies containing data source implementations (IDataSource)</p>
                        </div>
                        <div class="feature-card">
                            <h3>Addin</h3>
                            <p>Plugin assemblies that extend application functionality</p>
                        </div>
                        <div class="feature-card">
                            <h3>ConnectionDriver</h3>
                            <p>Assemblies containing database connection drivers</p>
                        </div>
                        <div class="feature-card">
                            <h3>ProjectClass</h3>
                            <p>Project-specific assemblies with custom business logic</p>
                        </div>
                        <div class="feature-card">
                            <h3>LoaderExtensions</h3>
                            <p>Assemblies that extend the loading and scanning capabilities</p>
                        </div>
                    </div>
                </section>

                <!-- Usage Examples -->
                <section class="section">
                    <h2>Usage Examples</h2>

                    <div class="method-item">
                        <h3>Creating Assembly Representations</h3>
                        <p>Example of creating assemblies_rep instances during assembly loading:</p>
                        
                        <div class="code-example">
                            <div class="code-header">
                                <span class="language">C#</span>
                                <button class="copy-btn" onclick="copyCode(this)">
                                    <i class="bi bi-clipboard"></i>
                                </button>
                            </div>
                            <pre><code class="language-csharp">public List&lt;assemblies_rep&gt; LoadAssembliesFromDirectory(
    string directoryPath, 
    FolderFileTypes fileType)
{
    var assemblyReps = new List&lt;assemblies_rep&gt;();
    
    foreach (var dllFile in Directory.GetFiles(directoryPath, "*.dll"))
    {
        try
        {
            var assembly = Assembly.LoadFrom(dllFile);
            var fileName = Path.GetFileName(dllFile);
            
            var rep = new assemblies_rep(
                assembly,
                directoryPath,
                fileName,
                fileType
            );
            
            assemblyReps.Add(rep);
            Console.WriteLine($"Loaded: {fileName} as {fileType}");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Failed to load {dllFile}: {ex.Message}");
        }
    }
    
    return assemblyReps;
}</code></pre>
                        </div>
                    </div>

                    <div class="method-item">
                        <h3>Filtering and Querying</h3>
                        <p>Example of filtering and querying assembly representations:</p>
                        
                        <div class="code-example">
                            <pre><code class="language-csharp">// Group assemblies by type
var assemblyGroups = assemblies
    .GroupBy(rep => rep.FileTypes)
    .ToList();

foreach (var group in assemblyGroups)
{
    Console.WriteLine($"{group.Key}: {group.Count()} assemblies");
    foreach (var rep in group)
    {
        Console.WriteLine($"  - {rep.DllName}");
    }
}

// Find specific assembly by name
var targetAssembly = assemblies
    .FirstOrDefault(rep => rep.DllName.Equals("MyPlugin.dll", 
                                              StringComparison.OrdinalIgnoreCase));

if (targetAssembly != null)
{
    Console.WriteLine($"Found assembly: {targetAssembly.DllLib.FullName}");
}</code></pre>
                        </div>
                    </div>

                    <div class="method-item">
                        <h3>Assembly Information Extraction</h3>
                        <p>Example of extracting detailed information from assembly representations:</p>
                        
                        <div class="code-example">
                            <pre><code class="language-csharp">public void AnalyzeAssembly(assemblies_rep assemblyRep)
{
    var assembly = assemblyRep.DllLib;
    
    Console.WriteLine($"Assembly Analysis: {assemblyRep.DllName}");
    Console.WriteLine($"Full Name: {assembly.FullName}");
    Console.WriteLine($"Location: {assembly.Location}");
    Console.WriteLine($"Source Path: {assemblyRep.DllLibPath}");
    Console.WriteLine($"Classification: {assemblyRep.FileTypes}");
    
    // Get assembly attributes
    var titleAttr = assembly.GetCustomAttribute&lt;AssemblyTitleAttribute&gt;();
    if (titleAttr != null)
    {
        Console.WriteLine($"Title: {titleAttr.Title}");
    }
    
    var versionAttr = assembly.GetCustomAttribute&lt;AssemblyVersionAttribute&gt;();
    if (versionAttr != null)
    {
        Console.WriteLine($"Version: {versionAttr.Version}");
    }
    
    // Count types by category
    var types = assembly.GetTypes();
    var interfaces = types.Count(t => t.IsInterface);
    var classes = types.Count(t => t.IsClass && !t.IsAbstract);
    var abstracts = types.Count(t => t.IsAbstract && t.IsClass);
    
    Console.WriteLine($"Interfaces: {interfaces}");
    Console.WriteLine($"Classes: {classes}");
    Console.WriteLine($"Abstract Classes: {abstracts}");
}</code></pre>
                        </div>
                    </div>

                    <div class="method-item">
                        <h3>Integration with AssemblyHandler</h3>
                        <p>Example of how assemblies_rep integrates with AssemblyHandler:</p>
                        
                        <div class="code-example">
                            <pre><code class="language-csharp">// Within AssemblyHandler.LoadAssembly method
public string LoadAssembly(string path, FolderFileTypes fileTypes)
{
    foreach (string dll in Directory.GetFiles(path, "*.dll"))
    {
        try
        {
            var loadedAssembly = Assembly.LoadFrom(dll);
            
            // Create representation
            var assemblyRep = new assemblies_rep(
                loadedAssembly, 
                path, 
                Path.GetFileName(dll), 
                fileTypes
            );
            
            // Add to collection
            Assemblies.Add(assemblyRep);
            
            // Scan the assembly for components
            ScanAssembly(loadedAssembly);
        }
        catch (Exception ex)
        {
            Logger.WriteLog($"Failed to load {dll}: {ex.Message}");
        }
    }
}</code></pre>
                        </div>
                    </div>
                </section>

                <!-- Integration Patterns -->
                <section class="section">
                    <h2>Integration Patterns</h2>

                    <div class="usage-pattern">
                        <h3>Assembly Management</h3>
                        <p>How assemblies_rep supports assembly lifecycle management:</p>
                        <div class="code-example">
                            <pre><code class="language-csharp">public class AssemblyManager
{
    private List&lt;assemblies_rep&gt; loadedAssemblies = new();
    
    public void LoadPluginDirectory(string pluginPath)
    {
        var newAssemblies = LoadAssembliesFromDirectory(
            pluginPath, 
            FolderFileTypes.Addin
        );
        
        // Track loaded assemblies
        loadedAssemblies.AddRange(newAssemblies);
        
        // Scan for specific interfaces
        foreach (var rep in newAssemblies)
        {
            ScanForPlugins(rep);
        }
    }
    
    public void UnloadAssemblies(FolderFileTypes fileType)
    {
        var toRemove = loadedAssemblies
            .Where(rep => rep.FileTypes == fileType)
            .ToList();
            
        foreach (var rep in toRemove)
        {
            loadedAssemblies.Remove(rep);
            // Additional cleanup if needed
        }
    }
}</code></pre>
                        </div>
                    </div>

                    <div class="usage-pattern">
                        <h3>Metadata Tracking</h3>
                        <p>Using assemblies_rep for comprehensive metadata tracking:</p>
                        <div class="code-example">
                            <pre><code class="language-csharp">public class AssemblyTracker
{
    public Dictionary&lt;FolderFileTypes, List&lt;assemblies_rep&gt;&gt; 
        GroupAssembliesByType(List&lt;assemblies_rep&gt; assemblies)
    {
        return assemblies
            .GroupBy(rep => rep.FileTypes)
            .ToDictionary(g => g.Key, g => g.ToList());
    }
    
    public void GenerateLoadReport(List&lt;assemblies_rep&gt; assemblies)
    {
        var report = new StringBuilder();
        report.AppendLine("Assembly Load Report");
        report.AppendLine("===================");
        
        var groups = GroupAssembliesByType(assemblies);
        
        foreach (var group in groups)
        {
            report.AppendLine($"\n{group.Key}: {group.Value.Count} assemblies");
            
            foreach (var rep in group.Value.OrderBy(r => r.DllName))
            {
                report.AppendLine($"  • {rep.DllName}");
                report.AppendLine($"    Path: {rep.DllLibPath}");
                report.AppendLine($"    Full Name: {rep.DllLib.FullName}");
            }
        }
        
        Console.WriteLine(report.ToString());
    }
}</code></pre>
                        </div>
                    </div>
                </section>

                <!-- Best Practices -->
                <section class="section">
                    <h2>Best Practices</h2>
                    
                    <div class="best-practices">
                        <div class="practice-item">
                            <h3><i class="bi bi-check-circle-fill"></i> Proper Classification</h3>
                            <p>Always use the appropriate FolderFileTypes value to ensure correct categorization and filtering.</p>
                        </div>
                        
                        <div class="practice-item">
                            <h3><i class="bi bi-check-circle-fill"></i> Path Validation</h3>
                            <p>Validate that DllLibPath exists and is accessible before creating assemblies_rep instances.</p>
                        </div>
                        
                        <div class="practice-item">
                            <h3><i class="bi bi-check-circle-fill"></i> Exception Handling</h3>
                            <p>Wrap assembly loading in try-catch blocks to handle corrupted or incompatible assemblies.</p>
                        </div>
                        
                        <div class="practice-item">
                            <h3><i class="bi bi-check-circle-fill"></i> Memory Management</h3>
                            <p>Be mindful of memory usage when loading many assemblies, especially in long-running applications.</p>
                        </div>
                    </div>
                </section>

                <!-- Related Topics -->
                <section class="section">
                    <h2>Related Topics</h2>
                    <div class="related-links">
                        <a href="assembly-handler.html" class="related-link">
                            <i class="bi bi-gear"></i>
                            <span>AssemblyHandler</span>
                        </a>
                        <a href="assembly-class-definition.html" class="related-link">
                            <i class="bi bi-file-code"></i>
                            <span>AssemblyClassDefinition</span>
                        </a>
                        <a href="../guides/assembly-loading.html" class="related-link">
                            <i class="bi bi-box-arrow-in-down"></i>
                            <span>Assembly Loading Guide</span>
                        </a>
                        <a href="../guides/getting-started.html" class="related-link">
                            <i class="bi bi-book"></i>
                            <span>Getting Started Guide</span>
                        </a>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-csharp.min.js"></script>
    <script src="../scripts/docs.js"></script>
</body>
</html>